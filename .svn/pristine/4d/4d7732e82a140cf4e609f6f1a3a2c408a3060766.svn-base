{"version":3,"sources":["ScrollViewBetter.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\component","sourcesContent":["const { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class ScrollViewBetter extends cc.Component {\r\n    @property(cc.Prefab)\r\n    itemPrefab: cc.Prefab = null;\r\n    @property(cc.Node)\r\n    contentNode: cc.Node = null;\r\n    @property(cc.Node)\r\n    viewNode: cc.Node = null;\r\n\r\n    @property\r\n    spacing: number = 0; // 间隔\r\n    @property\r\n    firstPadding: number = 0;\r\n    @property\r\n    lastPadding: number = 0;\r\n    @property\r\n    vertical: boolean = true; // 默认垂直模式，false为水平模式\r\n    @property\r\n    topToBottom: boolean = true; // 垂直模式默认滚动到顶部 从上到下\r\n    @property\r\n    leftToRight: boolean = true; // 水平模式默认滚动到左侧 从左到右\r\n\r\n    private itemWidth;\r\n    private itemHeight;\r\n    private itemListSize;\r\n    private innerItemCount;\r\n    private outerItemCount;\r\n    private totalItemCount;\r\n    private startItemIndex;\r\n    private firstItemIndex;\r\n    private topLimitPosY;\r\n    private bottomLimitPosY;\r\n    private leftLimitPosX;\r\n    private rightLimitPosX;\r\n\r\n    private itemNodeList;\r\n\r\n    private initItemCallback: Function;\r\n\r\n    createItems(itemListSize, initItemCallback, startIndex = 0) {\r\n        //item宽高\r\n        this.itemHeight = this.itemPrefab.data.height;\r\n        this.itemWidth = this.itemPrefab.data.width;\r\n\r\n        //初始化item回调\r\n        this.initItemCallback = initItemCallback;\r\n\r\n        //item列表大小\r\n        this.itemListSize = itemListSize;\r\n\r\n        this.contentNode.removeAllChildren();\r\n        if (this.vertical) { //垂直\r\n            // 设置内容高度\r\n            this.contentNode.height = this.firstPadding + this.itemListSize * (this.itemHeight + this.spacing) + this.lastPadding;\r\n            this.contentNode.width = this.itemListSize * this.itemWidth;\r\n            this.innerItemCount = Math.floor(this.viewNode.height / (this.itemHeight + this.spacing)) + 2;\r\n        } else {  //水平\r\n            // 设置内容高度\r\n            this.contentNode.height = this.itemListSize * this.itemHeight;\r\n            this.contentNode.width = this.firstPadding + this.itemListSize * (this.itemWidth + this.spacing) + this.lastPadding;\r\n            this.innerItemCount = Math.floor(this.viewNode.width / (this.itemWidth + this.spacing)) + 2;\r\n        }\r\n        this.outerItemCount = Math.floor(this.innerItemCount / 2) * 2;\r\n        this.totalItemCount = this.innerItemCount + this.outerItemCount;\r\n\r\n        //第一个显示的item索引\r\n        if (startIndex >= itemListSize) {\r\n            startIndex = itemListSize - 1;\r\n        }\r\n        if (startIndex < 0) {\r\n            startIndex = 0;\r\n        }\r\n        this.startItemIndex = startIndex;\r\n        this.firstItemIndex = startIndex - this.outerItemCount / 2;\r\n\r\n        if (this.vertical) {\r\n            if (this.topToBottom) {\r\n                this.contentNode.y = this.viewNode.height / 2 - this.contentNode.height / 2 + startIndex * (this.itemHeight + this.spacing);\r\n            } else {\r\n                this.contentNode.y = -(this.viewNode.height / 2 - this.contentNode.height / 2 + startIndex * (this.itemHeight + this.spacing));\r\n            }\r\n        } else {\r\n            if (this.leftToRight) {\r\n                this.contentNode.x = -(this.viewNode.width / 2 - this.contentNode.width / 2 + startIndex * (this.itemWidth + this.spacing));\r\n            } else {\r\n                this.contentNode.x = this.viewNode.width / 2 - this.contentNode.width / 2 + startIndex * (this.itemWidth + this.spacing);\r\n            }\r\n        }\r\n\r\n        // 遮罩\r\n        let viewNodeWorldPos = this.viewNode.convertToWorldSpaceAR(cc.v2(0, 0));\r\n        this.topLimitPosY = viewNodeWorldPos.y + this.totalItemCount * (this.itemHeight + this.spacing) / 2;\r\n        this.bottomLimitPosY = viewNodeWorldPos.y - this.totalItemCount * (this.itemHeight + this.spacing) / 2;\r\n        this.leftLimitPosX = viewNodeWorldPos.x - this.totalItemCount * (this.itemWidth + this.spacing) / 2;\r\n        this.rightLimitPosX = viewNodeWorldPos.x + this.totalItemCount * (this.itemWidth + this.spacing) / 2;\r\n\r\n        this.itemNodeList = [];\r\n        for (let i = this.firstItemIndex; i < this.totalItemCount + this.firstItemIndex; i++) {\r\n            let itemNode = cc.instantiate(this.itemPrefab);\r\n            itemNode.parent = this.contentNode;\r\n            this.setItem(itemNode, i);\r\n            this.itemNodeList.push(itemNode);\r\n        }\r\n        this.node.off('scrolling');\r\n        this.node.on('scrolling', () => {\r\n            this.updateItemsPos();\r\n        })\r\n    }\r\n\r\n    setItem(itemNode, index) {\r\n        // 垂直滚动\r\n        if (this.vertical) {\r\n            // 从上到下排序\r\n            if (this.topToBottom) {\r\n                itemNode.y = this.contentNode.height / 2 - (this.firstPadding + index * (this.itemHeight + this.spacing) + this.itemHeight / 2);\r\n            }\r\n            // 从下到上排序                \r\n            else {\r\n                itemNode.y = -(this.contentNode.height / 2 - (this.firstPadding + index * (this.itemHeight + this.spacing) + this.itemHeight / 2));\r\n            }\r\n        }\r\n        // 水平滚动\r\n        else {\r\n            // 从左往右排序\r\n            if (this.leftToRight) {\r\n                itemNode.x = -(this.contentNode.width / 2 - (this.firstPadding + index * (this.itemWidth + this.spacing) + this.itemWidth / 2));\r\n            }\r\n            // 从右往左排序                \r\n            else {\r\n                itemNode.x = this.contentNode.width / 2 - (this.firstPadding + index * (this.itemWidth + this.spacing) + this.itemWidth / 2);\r\n            }\r\n        }\r\n        if (index < 0 || index >= this.itemListSize) {\r\n            itemNode.active = false;\r\n        } else {\r\n            itemNode.active = true;\r\n            this.initItemCallback(itemNode, index);\r\n        }\r\n    }\r\n\r\n    updateItemsContent() {\r\n        this.itemNodeList.forEach((itemNode, index) => {\r\n            itemNode.active && this.initItemCallback(itemNode, index + this.firstItemIndex);\r\n        });\r\n    }\r\n\r\n    updateItemsPos() {\r\n        if (!this.itemNodeList || !this.itemNodeList.length) return;\r\n        let firstItem = this.itemNodeList[0];\r\n        let lastItem = this.itemNodeList[this.itemNodeList.length - 1];\r\n        //获取最上item当前的坐标\r\n        let firstPos = firstItem.convertToWorldSpaceAR(cc.v2(0, 0));\r\n        //获取最下item当前的坐标\r\n        let lastPos = lastItem.convertToWorldSpaceAR(cc.v2(0, 0));\r\n        //检测上item是否超过边界\r\n        let firstFlag = false, lastFlag = false;\r\n        // 垂直滚动\r\n        if (this.vertical) {\r\n            // 从上到下排序\r\n            if (this.topToBottom) {\r\n                firstFlag = firstPos.y > this.topLimitPosY;\r\n                lastFlag = lastPos.y < this.bottomLimitPosY;\r\n            }\r\n            // 从下到上排序\r\n            else {\r\n                firstFlag = firstPos.y < this.bottomLimitPosY;\r\n                lastFlag = lastPos.y > this.topLimitPosY;\r\n            }\r\n        }\r\n        // 水平滚动\r\n        else {\r\n            // 从左往右排序\r\n            if (this.leftToRight) {\r\n                firstFlag = firstPos.x < this.leftLimitPosX;\r\n                lastFlag = lastPos.x > this.rightLimitPosX;\r\n            }\r\n            // 从右往左排序\r\n            else {\r\n                firstFlag = firstPos.x > this.rightLimitPosX;\r\n                lastFlag = lastPos.x < this.leftLimitPosX;\r\n            }\r\n        }\r\n        if (firstFlag) {\r\n            this.setItem(firstItem, this.firstItemIndex + this.totalItemCount);\r\n            this.firstItemIndex++;\r\n            let itemNode = this.itemNodeList.shift();\r\n            this.itemNodeList.push(itemNode);\r\n        }\r\n        //检测下item是否超过边界\r\n        else if (lastFlag) {\r\n            this.setItem(lastItem, this.firstItemIndex - 1);\r\n            this.firstItemIndex--;\r\n            let itemNode = this.itemNodeList.pop();\r\n            this.itemNodeList.unshift(itemNode);\r\n        }\r\n    }\r\n}"]}